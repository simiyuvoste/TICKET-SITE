<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ticket Purchase</title>
</head>
<body style="font-family: Arial, sans-serif; text-align: center; padding: 40px;">
  <h1>ðŸŽ« Buy Your Ticket</h1>
  <p>Enter the amount you wish to pay and complete via PayPal.</p>

  <!-- Amount input -->
  <label for="amount">Enter Amount (USD):</label>
  <input type="number" id="amount" min="1" value="10" />
  
  <!-- PayPal button -->
  <div id="paypal-button-container" style="margin-top:20px;"></div>

  <!-- PayPal SDK -->
  <script src="https://www.paypal.com/sdk/js?client-id=AeBD7HQ7dGDhb5EhQwJBhOedonk1naY2l4puM5hbXzF6FnCD0cL16kLM_qESHaD5uvxXYDjYZg5mM83o&currency=USD"></script>

  <script>
  paypal.Buttons({
    createOrder: function(data, actions) {
      let amount = document.getElementById("amount").value;
      if (!amount || amount <= 0) {
        alert("Please enter a valid amount");
        return;
      }
      return actions.order.create({
        purchase_units: [{
          amount: { value: amount }
        }]
      });
    },
    onApprove: function(data, actions) {
      return actions.order.capture().then(function(details) {
        let payer = details.payer.name.given_name;
        let paidAmount = details.purchase_units[0].amount.value;

        alert("Transaction completed by " + payer + " for $" + paidAmount);

        // Generate ticket with correct amount
        generateTicket(payer, paidAmount);
      });
    }
  }).render('#paypal-button-container');

  function generateTicket(name, amount) {
    let ticketWindow = window.open("", "Ticket", "width=400,height=600");
    ticketWindow.document.write(`
      <html>
        <head>
          <title>Your Ticket</title>
          <style>
            body { font-family: Arial, sans-serif; text-align: center; }
            .ticket { border: 2px dashed #333; padding: 20px; margin: 20px; }
            h2 { color: #0070ba; }
          </style>
        </head>
        <body>
          <div class="ticket">
            <h2>ðŸŽ« Event Ticket</h2>
            <p><b>Name:</b> ${name}</p>
            <p><b>Amount Paid:</b> $${amount}</p>
            <p><b>Transaction ID:</b> ${new Date().getTime()}</p>
            <p>Thank you for your purchase!</p>
          </div>
        </body>
      </html>
    `);
    ticketWindow.document.close();
  }
  </script>
</body>
</html>
